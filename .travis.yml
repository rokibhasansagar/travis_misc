os: linux
dist: bionic
language: python
python:
  - "3.7"
addons:
  apt:
    update: true
sudo: required
git:
  depth: 1
install: pip3 install git-filter-repo
script:
  - git clone https://github.com/PitchBlackRecoveryProject/vendor_pb -b pb
  - cd vendor_pb
  - git-filter-repo --analyze
  - cd .git/filter-repo/
  - tar cJf analysis.tar.xz analysis/*
  - curl -F "file=@analysis.tar.xz" https://file.io; echo ""
  - git-filter-repo --path PBRP --path PBTWRP --path build/core --path build/soong --path build/tasks --path build/tools --path build/envsetup.sh --path config --path sepolicy --path updater --path .pb.1 --path pb --path Android.mk --path LICENSE --path Release.jar --path __sample.circleci.yml --path build.sh --path pb_build.sh --path deploy.sh --path pb_deploy.sh --path pb_upload.sh --path utils --path telegram.sh --path telegram --path pb.devices --path pb.releases --preserve-commit-hashes --partial --dry-run --debug
